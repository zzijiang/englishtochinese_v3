<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•ç»“æœ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/fireworks-js@2/dist/index.umd.js"></script> <!-- å¼•å…¥çƒŸèŠ±åŠ¨ç”»åº“ -->
</head>
<body>
    <div class="container">
        <h1>æµ‹è¯•å®Œæˆï¼</h1>
        <p>ä½ çš„å¾—åˆ†ï¼š{{ score }} / {{ total }}</p>

        {% if score == total %}
            <h2 class="congrats">ğŸ‰ æ­å–œä½ å…¨éƒ¨ç­”å¯¹ï¼ğŸ‰</h2>
            <div id="fireworks-container"></div> <!-- çƒŸèŠ±åŠ¨ç”»çš„å®¹å™¨ -->
        {% else %}
            <h2>ä»¥ä¸‹æ˜¯ä½ çš„é”™é¢˜ï¼š</h2>
            <ul class="wrong-list">
                {% for item in wrong_answers %}
                    <li>
                        <strong>{{ item.english }}</strong>  
                        <br><span class="black-text">æ­£ç¡®ç­”æ¡ˆï¼š</span> <span class="green-text">{{ item.correct }}</span>
                        <br><span class="wrong">ä½ çš„ç­”æ¡ˆï¼š{{ item.your_answer }}</span>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}

        <a href="{{ url_for('index') }}" class="restart-btn">å†æ¥ä¸€å±€</a>
    </div>

    <script>
        // å¦‚æœç”¨æˆ·æ»¡åˆ†ï¼Œåˆ™å¯åŠ¨çƒŸèŠ±åŠ¨ç”»
        {% if score == total %}
        document.addEventListener("DOMContentLoaded", function() {
            const container = document.getElementById("fireworks-container");
            container.style.position = "fixed";
            container.style.top = "0";
            container.style.left = "0";
            container.style.width = "100vw";
            container.style.height = "100vh";
            container.style.pointerEvents = "none"; // ç¡®ä¿åŠ¨ç”»ä¸ä¼šå½±å“å…¶ä»–ç‚¹å‡»æ“ä½œ

            // åˆå§‹åŒ–çƒŸèŠ±
            const fireworks = new Fireworks.default(container, {
                autoresize: true,
                opacity: 0.6,
                acceleration: 1.05,
                friction: 0.97,
                gravity: 1.5,
                particles: 100,
                traceLength: 3,
                traceSpeed: 10,
                explosion: 8,
                intensity: 20,
                flickering: 50,
                lineWidth: {
                    explosion: { min: 1, max: 4 },
                    trace: { min: 1, max: 2 }
                },
                brightness: { min: 50, max: 100 },
                decay: { min: 0.02, max: 0.04 },
                delay: { min: 30, max: 60 },
                hue: { min: 0, max: 360 },
                sound: {
                    enabled: true, // å¯ç”¨å£°éŸ³
                    files: ["https://www.soundjay.com/misc/sounds/fireworks-1.mp3"],
                    volume: { min: 1, max: 3 }
                }
            });

            fireworks.start(); // å¼€å§‹çƒŸèŠ±åŠ¨ç”»
        });
        {% endif %}
    </script>
</body>
</html>
